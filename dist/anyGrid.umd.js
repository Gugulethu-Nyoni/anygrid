!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).AnyGrid=t()}(this,(function(){"use strict";return class{constructor(e,t,i={}){this.data=e,this.totalRecords=e.length,this.columns=t,this.itemsPerPage=i.initialItemsPerPage||10,this.currentPage=1,this.tbody=null,this.searchInput=null,this.paginationContainer=null,this.filteredData=this.data,this.sortingOrder={},this.dataTableId=this.generateUniqueId("anygrid-datatable"),this.paginationContainerId=this.generateUniqueId("anygrid-pagination"),this.searchInputId=this.generateUniqueId("search-input"),this.itemsPerPageId=this.generateUniqueId("items-per-page"),this.gridContainerId=i.gridContainerId||"anygrid";this.features={search:!0,sort:!0,actions:!0,pagination:!0,itemsPerPage:!0,dynamicHeaders:!0,renderActionsInRows:!0,...i},this.initializeDataGrid(),alert(this.features.search),this.features.search&&(this.searchInput=document.getElementById(`${this.searchInputId}`),this.searchInput.addEventListener("input",this.searchTable.bind(this)))}generateUniqueId(e){return`${e}-${Math.random().toString(36).substring(2,7)}`}initializeDataGrid(){const e=document.getElementById(this.gridContainerId);if(e){const t=[5,10,20,50,100],i=this.features.itemsPerPage?t.map((e=>`\n        <option value="${e}" ${e===this.itemsPerPage?"selected":""}>${e}</option>\n      `)).join(""):"",n=`\n        <div class="search-container"> \n          ${this.features.search?`<input type="text" id="${this.searchInputId}" class="anygrid-search-input" placeholder="Search...">`:""}\n          ${this.features.itemsPerPage?`<select id="${this.itemsPerPageId}" class="items-per-page">${i}</select>`:""}\n        </div>\n        \n        <table class="anygrid-table" id="${this.dataTableId}">\n          <thead>\n            <tr></tr>\n          </thead>\n          <tbody></tbody>\n        </table>\n        ${this.features.pagination?`<div id="${this.paginationContainerId}" class="anygrid-pagination"></div>`:""}\n      `;if(e.insertAdjacentHTML("afterbegin",n),this.features.itemsPerPage){const e=document.getElementById(`${this.itemsPerPageId}`);e.value=this.itemsPerPage,e.addEventListener("change",(e=>{this.itemsPerPage=parseInt(e.target.value),this.currentPage=1,this.renderData(),this.updatePagination()}))}this.features.search&&(this.searchInput=document.getElementById(this.searchInputId),this.searchInput.addEventListener("input",this.searchTable.bind(this))),this.tbody=document.querySelector(`#${this.dataTableId} tbody`),this.paginationContainer=document.getElementById(`${this.paginationContainerId}`),this.renderData(this.filteredData),this.updatePagination()}}renderData(){this.tbody.innerHTML="";const e=document.querySelector(`#${this.dataTableId} thead tr`);let t,i;e.innerHTML="",this.features.dynamicHeaders&&this.columns.forEach(((t,i)=>{if(!t.hidden){const n=document.createElement("th");if(n.textContent=t.label||t.header,t.joinedColumns)n.setAttribute("colspan",t.joinedColumns.length);else if(this.features.sort&&t.sortable){n.dataset.index=i,n.addEventListener("click",(()=>this.sortTable(i)));const e=document.createElement("span");e.innerHTML=" â‡…",e.style.fontSize="1.1em",e.style.marginLeft="0.2em",e.className="anygrid-column-sortable",n.appendChild(e)}e.appendChild(n)}})),this.features.pagination?(t=(this.currentPage-1)*this.itemsPerPage,i=Math.min(this.currentPage*this.itemsPerPage,this.filteredData.length)):(t=0,i=this.totalRecords),this.filteredData.slice(t,i).forEach((e=>{const t=document.createElement("tr");if(this.columns.forEach((i=>{if(!i.hidden){const n=document.createElement("td");let a=i.joinedColumns?i.joinedColumns.map((t=>e[t])).join(" "):e[i.name];i.render?"string"==typeof i.render?n.innerHTML=i.render.replace(`{${i.name}}`,a):"function"==typeof i.render&&(n.innerHTML=i.render(a,e)):i.joinedColumns?(n.textContent=a,n.setAttribute("colspan",i.joinedColumns.length)):n.textContent=a,t.appendChild(n)}})),this.features.actions){const i=this.columns.find((e=>e.actions));i&&this.features.renderActionsInRows&&i.actions.forEach((i=>{const n=document.createElement("td"),a=document.createElement("a");a.textContent=i.label,a.href=i.url.replace("{id}",e.id),i.class&&a.classList.add(i.class),i.id&&(a.id=i.id.replace("{id}",e.id)),i.confirm&&a.setAttribute("onclick","return confirm('Are you sure?')"),n.appendChild(a),t.appendChild(n)}))}this.tbody.appendChild(t)})),this.updatePagination()}updatePagination(){if(this.features.pagination){const e=this.itemsPerPage,t=Math.ceil(this.filteredData.length/e),i=Math.max(1,this.currentPage-5),n=Math.min(i+9,t);this.paginationContainer.innerHTML="";for(let e=i;e<=n;e++){const t=document.createElement("button");t.textContent=e,t.classList.add("pagination-button"),e===this.currentPage&&t.classList.add("active"),t.onclick=()=>{this.currentPage=e,this.renderData()},this.paginationContainer.appendChild(t)}}}sortTable(e){if(this.features.sort){const t=this.columns[e],i="asc"!==this.sortingOrder[t.name],n=[...this.filteredData].sort(((e,n)=>{let a=e[t.name],s=n[t.name];return"number"===t.type&&(a=parseFloat(a),s=parseFloat(s)),i?a-s:s-a}));this.filteredData=n,this.sortingOrder[t.name]=i?"asc":"desc",this.renderData()}}searchTable(){const e=this.searchInput.value.toLowerCase();this.filteredData=this.data.filter((t=>this.columns.some((i=>{let n=i.joinedColumns?i.joinedColumns.map((e=>t[e])).join(" "):t[i.name];return null==n&&(n=""),"string"!=typeof n&&(n=String(n)),n.toLowerCase().includes(e)})))),this.currentPage=1,this.renderData()}}}));
